(()=>{var t,e={229:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(5699),o=n(254);e.default=class{constructor(t){this.bus=t,this.pages=new Map,this.activePage=null,this.bus.bind(i.NavigationEvent.Topic,i.isNavigationEvent,t=>{this.handleNavigationEvent(t)})}registerPage(t,e){this.pages.set(t,e)}handleNavigationEvent(t){t instanceof i.NavigationEvent.OpenPage&&this.openPage(t.page)}openPage(t){const e=(0,o.checkNotNull)(this.pages.get(t),`Could not open unregistered page with tag '${t}'`);this.activePage?.hide(),this.activePage=e,this.activePage.show()}}},242:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.QrPage=void 0;const o=n(254),r=i(n(2524)),s=n(8376),a=n(2432),d=n(5699),c=i(n(7283)),l=n(8580),u=n(3118),h=n(2946),g=u.defaultLogger.child("QrPage");class f{constructor(t){this.root=t,this.qrCanvas=(0,o.checkNotNull)(t.querySelector("#qr-canvas"),"Could not find qr canvas"),this.backButton=(0,o.checkNotNull)(t.querySelector("#back"),"Could not find back button"),this.hiddenModeInput=(0,o.checkNotNull)(t.querySelector("#hidden-mode"),"Could not find hidden mode input")}static inflate(){const t=document.createElement("div");return t.id=this.LAYOUT_ID,t.innerHTML=r.default,t.hidden=!0,new f(t)}}f.LAYOUT_ID="qr-page";class p extends s.BasePage{constructor(t,e){super(t),this.authService=e,this.stopPolling=!1,this.binding=f.inflate(),this.popup=new a.PopupBinding,this.binding.backButton.addEventListener("click",()=>{this.onClickBackButton()})}clearQrCode(){let t=this.binding.qrCanvas.firstChild;for(;t;)this.binding.qrCanvas.removeChild(t),t=this.binding.qrCanvas.firstChild}showQrCode(t){this.clearQrCode(),new c.default({width:250,height:250,type:"svg",data:t,dotsOptions:{type:"rounded",gradient:{type:"linear",rotation:Math.PI/2,colorStops:[{offset:0,color:"#2196F3"},{offset:1,color:"#64B5F6"}]}},margin:5,backgroundOptions:{color:"#ffffff"},imageOptions:{crossOrigin:"anonymous",margin:0,imageSize:.36}}).append(this.binding.qrCanvas)}async startPolling(t){for(;!this.stopPolling;)try{const e=await this.authService.qrLogin(t);if(e===l.AuthResult.Success)return!0;if(e===l.AuthResult.Retry)continue;return!1}catch(t){return g.error("Could not perform login with qr",(0,h.extras)({error:t})),!1}return this.stopPolling=!1,!1}show(){document.querySelector("#"+f.LAYOUT_ID)||(this.popup.container.prepend(this.binding.root),this.binding.hiddenModeInput.checked=!0),this.authService.generateQrData().then(t=>{const e=t;this.showQrCode(e);const n={qr_data:e,timeout:30,hiddenMode:!0};this.startPolling(n).then(t=>{t&&this.navigateTo(d.PageTag.Main)})}),this.binding.root.hidden=!1}hide(){this.binding.root.hidden=!0}onClickBackButton(){this.stopPolling=!0,this.navigateTo(d.PageTag.Login)}}e.QrPage=p},398:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.LoginPage=void 0;const o=n(8376),r=i(n(4702)),s=n(254),a=n(2432),d=n(8580),c=n(5699),l=i(n(6815)),u=n(7766);class h{constructor(t){this.root=t,this.loginForm=(0,s.checkNotNull)(t.querySelector("#login-form"),"Could not find login form"),this.usernameInput=(0,s.checkNotNull)(t.querySelector("#username"),"Could not find username input"),this.passwordInput=(0,s.checkNotNull)(t.querySelector("#password"),"Could not find password input"),this.hiddenModeInput=(0,s.checkNotNull)(t.querySelector("#hidden-mode"),"Could not find hidden mode input"),this.authError=(0,s.checkNotNull)(t.querySelector("#auth-error"),"Could not find wrong login paragraph"),this.backButton=(0,s.checkNotNull)(t.querySelector("#back"),"Could not find back button"),this.qrButton=(0,s.checkNotNull)(t.querySelector("#qrLoginButton"),"Could not find qr button"),this.loginButtonGroup=(0,s.checkNotNull)(t.querySelector("#login-btn-group"),"Could not find login-btn-group");const e=(0,s.checkNotNull)(t.querySelector("#login"),"Could not find login button");this.loginButton=new u.SpinnerButton(e)}static inflate(){const t=document.createElement("div");return t.id=this.LAYOUT_ID,t.innerHTML=r.default,t.hidden=!0,new h(t)}}h.LAYOUT_ID="login-page";class g extends o.BasePage{constructor(t,e,n){super(t),this.authService=e,this.qrAuthFeatureEnabled=n,this.binding=h.inflate(),this.popup=new a.PopupBinding,this.binding.loginForm.addEventListener("submit",t=>{t.preventDefault(),this.binding.loginButton.isLoading||this.onSubmitLoginForm().then()}),this.binding.backButton.addEventListener("click",()=>{this.onClickBackButton()}),this.binding.qrButton.addEventListener("click",()=>{this.onClickQrButton()})}show(){document.querySelector("#"+h.LAYOUT_ID)||(this.popup.container.prepend(this.binding.root),this.qrAuthFeatureEnabled||(this.binding.qrButton.hidden=!0,this.binding.loginButtonGroup.classList.remove("btn-group"),this.binding.loginButtonGroup.classList.add("d-flex","flex-column"))),this.resetPage(),this.binding.root.hidden=!1}hide(){this.binding.root.hidden=!0}resetPage(){this.binding.usernameInput.value="",this.binding.passwordInput.value="",this.binding.hiddenModeInput.checked=!0,this.binding.loginButton.isLoading=!1,this.resetAuthError()}setAuthError(t){this.binding.authError.textContent=t,this.binding.authError.classList.remove("invisible")}resetAuthError(){this.binding.authError.classList.add("invisible")}async onSubmitLoginForm(){const t=new FormData(this.binding.loginForm),e=(0,s.checkNotNull)(t.get("username")?.toString(),"Username is null despite form validation"),n=(0,s.checkNotNull)(t.get("password")?.toString(),"Password is null despite form validation"),i="on"===t.get("hiddenMode");switch(this.resetAuthError(),this.binding.loginButton.isLoading=!0,await this.authService.login({username:e,password:n,hiddenMode:i})){case d.AuthResult.Success:this.navigateTo(c.PageTag.Main);break;case d.AuthResult.InvalidCredentials:this.setAuthError(l.default.i18n.getMessage("invalidLoginOrPassword"));break;case d.AuthResult.Error:this.setAuthError(l.default.i18n.getMessage("genericAuthError"))}this.binding.loginButton.isLoading=!1}onClickBackButton(){this.navigateTo(c.PageTag.Main)}onClickQrButton(){this.navigateTo(c.PageTag.QrPage)}}e.LoginPage=g},1940:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=n(3118),r=i(n(229)),s=i(n(5045)),a=i(n(1857)),d=n(6884),c=n(398),l=n(5699),u=n(8344),h=n(6226),g=n(4139),f=n(242),p=n(4663),w=n(3136),v=n(3342),b=n(3729),m=o.defaultLogger.child("Popup");Object.defineProperty(window,"isSyncSharePopup",{value:!0,writable:!1,enumerable:!0,configurable:!1}),async function(){m.info("Initializing popup...");const t=a.default.getInstance(),e=await(0,b.getSettings)(t,m);if(!e)return;e.allowTechnicalDataCollection&&s.default.init();const n=new r.default(t),i=new p.FeatureFlagServiceContent(t),o=await i.isEnabled(w.FeatureFlags.Account),y=await i.isEnabled(w.FeatureFlags.QrAuth);if(m.info(`accountFeatureEnabled = ${o}, qrAuthFeatureEnabled = ${y}`),n.registerPage(l.PageTag.Settings,new u.SettingsPage(t,o)),n.registerPage(l.PageTag.DiagnosticPage,new v.DiagnosticPage(t)),o){const e=new h.AccountServiceContent(t),i=new g.AuthServiceContent(t);n.registerPage(l.PageTag.Main,new d.MainPage(t,e,i)),n.registerPage(l.PageTag.Login,new c.LoginPage(t,i,y)),y&&n.registerPage(l.PageTag.QrPage,new f.QrPage(t,i)),t.publishLocally(l.NavigationEvent.Topic,new l.NavigationEvent.OpenPage(l.PageTag.Main))}else t.publishLocally(l.NavigationEvent.Topic,new l.NavigationEvent.OpenPage(l.PageTag.Settings));m.info("Popup initialized.")}().then()},1941:(t,e,n)=>{"use strict";n.r(e),n.d(e,{downloadZip:()=>B,makeZip:()=>M,predictLength:()=>x}),"stream"in Blob.prototype||Object.defineProperty(Blob.prototype,"stream",{value(){return new Response(this).body}}),"setBigUint64"in DataView.prototype||Object.defineProperty(DataView.prototype,"setBigUint64",{value(t,e,n){const i=Number(0xffffffffn&e),o=Number(e>>32n);this.setUint32(t+(n?0:4),i,n),this.setUint32(t+(n?4:0),o,n)}});var i=t=>new DataView(new ArrayBuffer(t)),o=t=>new Uint8Array(t.buffer||t),r=t=>(new TextEncoder).encode(String(t)),s=t=>Math.min(4294967295,Number(t)),a=t=>Math.min(65535,Number(t));function d(t,e,n){void 0===e||e instanceof Date||(e=new Date(e));const i=void 0!==t;if(n||(n=i?436:509),t instanceof File)return{isFile:i,t:e||new Date(t.lastModified),bytes:t.stream(),mode:n};if(t instanceof Response)return{isFile:i,t:e||new Date(t.headers.get("Last-Modified")||Date.now()),bytes:t.body,mode:n};if(void 0===e)e=new Date;else if(isNaN(e))throw new Error("Invalid modification date.");if(!i)return{isFile:i,t:e,mode:n};if("string"==typeof t)return{isFile:i,t:e,bytes:r(t),mode:n};if(t instanceof Blob)return{isFile:i,t:e,bytes:t.stream(),mode:n};if(t instanceof Uint8Array||t instanceof ReadableStream)return{isFile:i,t:e,bytes:t,mode:n};if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return{isFile:i,t:e,bytes:o(t),mode:n};if(Symbol.asyncIterator in t)return{isFile:i,t:e,bytes:c(t[Symbol.asyncIterator]()),mode:n};throw new TypeError("Unsupported input format.")}function c(t,e=t){return new ReadableStream({async pull(e){let n=0;for(;e.desiredSize>n;){const i=await t.next();if(!i.value){e.close();break}{const t=l(i.value);e.enqueue(t),n+=t.byteLength}}},cancel(t){e.throw?.(t)}})}function l(t){return"string"==typeof t?r(t):t instanceof Uint8Array?t:o(t)}function u(t,e,n){let[i,s]=function(t){return t?t instanceof Uint8Array?[t,1]:ArrayBuffer.isView(t)||t instanceof ArrayBuffer?[o(t),1]:[r(t),0]:[void 0,0]}(e);if(t instanceof File)return{i:g(i||r(t.name)),o:BigInt(t.size),u:s};if(t instanceof Response){const e=t.headers.get("content-disposition"),o=e&&e.match(/;\s*filename\*?\s*=\s*(?:UTF-\d+''|)["']?([^;"'\r\n]*)["']?(?:;|$)/i),a=o&&o[1]||t.url&&new URL(t.url).pathname.split("/").findLast(Boolean),d=a&&decodeURIComponent(a),c=n||+t.headers.get("content-length");return{i:g(i||r(d)),o:BigInt(c),u:s}}return i=g(i,void 0!==t||void 0!==n),"string"==typeof t?{i,o:BigInt(r(t).length),u:s}:t instanceof Blob?{i,o:BigInt(t.size),u:s}:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?{i,o:BigInt(t.byteLength),u:s}:{i,o:h(t,n),u:s}}function h(t,e){return e>-1?BigInt(e):t?void 0:0n}function g(t,e=1){if(!t||t.every(t=>47===t))throw new Error("The file must have a name.");if(e)for(;47===t[t.length-1];)t=t.subarray(0,-1);else 47!==t[t.length-1]&&(t=new Uint8Array([...t,47]));return t}var f=new Uint32Array(256);for(let t=0;t<256;++t){let e=t;for(let t=0;t<8;++t)e=e>>>1^(1&e&&3988292384);f[t]=e}function p(t,e=0){e=~e;for(var n=0,i=t.length;n<i;n++)e=e>>>8^f[255&e^t[n]];return~e>>>0}function w(t,e,n=0){const i=t.getSeconds()>>1|t.getMinutes()<<5|t.getHours()<<11,o=t.getDate()|t.getMonth()+1<<5|t.getFullYear()-1980<<9;e.setUint16(n,i,1),e.setUint16(n+2,o,1)}function v({i:t,u:e},n){return 8*(!e||(n??function(t){try{b.decode(t)}catch{return 0}return 1}(t)))}var b=new TextDecoder("utf8",{fatal:1});function m(t,e=0){const n=i(30);return n.setUint32(0,1347093252),n.setUint32(4,754976768|e),w(t.t,n,10),n.setUint16(26,t.i.length,1),o(n)}async function*y(t){let{bytes:e}=t;if("then"in e&&(e=await e),e instanceof Uint8Array)yield e,t.l=p(e,0),t.o=BigInt(e.length);else{t.o=0n;const n=e.getReader();for(;;){const{value:e,done:i}=await n.read();if(i)break;t.l=p(e,t.l),t.o+=BigInt(e.length),yield e}}}function _(t,e){const n=i(16+(e?8:0));return n.setUint32(0,1347094280),n.setUint32(4,t.isFile?t.l:0,1),e?(n.setBigUint64(8,t.o,1),n.setBigUint64(16,t.o,1)):(n.setUint32(8,s(t.o),1),n.setUint32(12,s(t.o),1)),o(n)}function k(t,e,n=0,r=0){const a=i(46);return a.setUint32(0,1347092738),a.setUint32(4,755182848),a.setUint16(8,2048|n),w(t.t,a,12),a.setUint32(16,t.isFile?t.l:0,1),a.setUint32(20,s(t.o),1),a.setUint32(24,s(t.o),1),a.setUint16(28,t.i.length,1),a.setUint16(30,r,1),a.setUint16(40,t.mode|(t.isFile?32768:16384),1),a.setUint32(42,s(e),1),o(a)}function S(t,e,n){const r=i(n);return r.setUint16(0,1,1),r.setUint16(2,n-4,1),16&n&&(r.setBigUint64(4,t.o,1),r.setBigUint64(12,t.o,1)),r.setBigUint64(n-8,e,1),o(r)}function C(t){return t instanceof File||t instanceof Response?[[t],[t]]:[[t.input,t.name,t.size],[t.input,t.lastModified,t.mode]]}var x=t=>function(t){let e=BigInt(22),n=0n,i=0;for(const o of t){if(!o.i)throw new Error("Every file must have a non-empty name.");if(void 0===o.o)throw new Error(`Missing size for file "${(new TextDecoder).decode(o.i)}".`);const t=o.o>=0xffffffffn,r=n>=0xffffffffn;n+=BigInt(46+o.i.length+(t&&8))+o.o,e+=BigInt(o.i.length+46+(12*r|28*t)),i||(i=t)}return(i||n>=0xffffffffn)&&(e+=BigInt(76)),e+n}(function*(t){for(const e of t)yield u(...C(e)[0])}(t));function B(t,e={}){const n={"Content-Type":"application/zip","Content-Disposition":"attachment"};return("bigint"==typeof e.length||Number.isInteger(e.length))&&e.length>0&&(n["Content-Length"]=String(e.length)),e.metadata&&(n["Content-Length"]=String(x(e.metadata))),new Response(M(t,e),{headers:n})}function M(t,e={}){const n=function(t){const e=t[Symbol.iterator in t?Symbol.iterator:Symbol.asyncIterator]();return{async next(){const t=await e.next();if(t.done)return t;const[n,i]=C(t.value);return{done:0,value:Object.assign(d(...i),u(...n))}},throw:e.throw?.bind(e),[Symbol.asyncIterator](){return this}}}(t);return c(async function*(t,e){const n=[];let r=0n,d=0n,c=0;for await(const i of t){const t=v(i,e.buffersAreUTF8);yield m(i,t),yield new Uint8Array(i.i),i.isFile&&(yield*y(i));const o=i.o>=0xffffffffn,s=12*(r>=0xffffffffn)|28*o;yield _(i,o),n.push(k(i,r,t,s)),n.push(i.i),s&&n.push(S(i,r,s)),o&&(r+=8n),d++,r+=BigInt(46+i.i.length)+i.o,c||(c=o)}let l=0n;for(const t of n)yield t,l+=BigInt(t.length);if(c||r>=0xffffffffn){const t=i(76);t.setUint32(0,1347094022),t.setBigUint64(4,BigInt(44),1),t.setUint32(12,755182848),t.setBigUint64(24,d,1),t.setBigUint64(32,d,1),t.setBigUint64(40,l,1),t.setBigUint64(48,r,1),t.setUint32(56,1347094023),t.setBigUint64(64,r+l,1),t.setUint32(72,1,1),yield o(t)}const u=i(22);u.setUint32(0,1347093766),u.setUint16(8,a(d),1),u.setUint16(10,a(d),1),u.setUint32(12,s(l),1),u.setUint32(16,s(r),1),yield o(u)}(n,e),n)}},2432:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PopupBinding=void 0;const i=n(254);e.PopupBinding=class{constructor(){this.container=(0,i.checkNotNull)(document.body.querySelector("#container"),"Could not find popup container")}}},2524:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i='<div class="mb-2"> <h5 class="text-center">Авторизация</h5> </div> <div id="qr-canvas"></div> <div class="d-flex justify-content-center"> <div class="form-check"> <input id="hidden-mode" class="form-check-input" type="checkbox" name="hiddenMode" disabled="disabled"/> <label class="form-check-label" for="hidden-mode"> Только на один тест </label> </div> </div> <div class="d-flex flex-column mt-4"> <button id="back" type="button" class="btn btn-outline-secondary">Назад</button> </div> '},3342:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.DiagnosticPage=void 0;const o=n(8376),r=i(n(1857)),s=i(n(5872)),a=n(254),d=n(2432),c=n(5699),l=n(7766),u=n(7921),h=n(1941),g=i(n(4213)),f=n(2592),p=n(2159);class w{constructor(t){this.root=t;const e=(0,a.checkNotNull)(t.querySelector("#download-diagnostic"),"Could not find download diagnostic button");this.downloadButton=new l.SpinnerButton(e),this.backButton=(0,a.checkNotNull)(t.querySelector("#back"),"Could not find back button")}static inflate(){const t=document.createElement("div");return t.id=this.LAYOUT_ID,t.innerHTML=s.default,t.hidden=!0,new w(t)}}w.LAYOUT_ID="diagnostic-page";class v extends o.BasePage{constructor(t){super(t),this.pageHtmlCollector=f.PageHtmlDiagnosticCollector.connect(r.default.getInstance()),this.binding=w.inflate(),this.popup=new d.PopupBinding,this.binding.downloadButton.root.addEventListener("click",()=>{this.onClickDownloadDiagnostic()}),this.binding.backButton.addEventListener("click",()=>{this.onClickBackButton()})}show(){document.querySelector("#"+w.LAYOUT_ID)||this.popup.container.prepend(this.binding.root),this.binding.root.hidden=!1,this.binding.downloadButton.isLoading=!1}hide(){this.binding.root.hidden=!0}async onClickDownloadDiagnostic(){if(this.binding.downloadButton.isLoading)return;this.binding.downloadButton.isLoading=!0;const t=[];t.push({name:"base_diagnostic.json",lastModified:new Date,input:JSON.stringify(await u.baseDiagnostic.collect())});const e=(await(0,p.runCatching)(()=>this.pageHtmlCollector.collect())).getOrNull();null!==e&&"html"in e&&null!==e.html&&"string"==typeof e.html&&t.push({name:"current_page.html",lastModified:new Date,input:e.html});const n=await(0,h.downloadZip)(t).blob();this.binding.downloadButton.isLoading=!1,g.default.saveAs(n,"SyncShare_Diagnostic.zip")}onClickBackButton(){this.navigateTo(c.PageTag.Main)}}e.DiagnosticPage=v},4111:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.diagnosticGroupOf=e.DiagnosticGroup=void 0;class n{constructor(...t){this.collectors=new Map,t.forEach(t=>{this.collectors.set(t.key,t)})}addCollector(t){this.collectors.set(t.key,t)}async collect(){const t={};for(const[e,n]of this.collectors.entries())try{t[e]=await n.collect()}catch(n){n instanceof Error?t[e]=`Diagnostic processing error (${n.name}): ${n.message}`:t[e]="Unknown diagnostic processing error"}return t}}e.DiagnosticGroup=n,e.diagnosticGroupOf=function(t,...e){return new class extends n{constructor(){super(...e),this.key=t}}}},4213:function(t,e,n){var i,o;void 0===(o="function"==typeof(i=function(){"use strict";function e(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){a(i.response,e,n)},i.onerror=function(){console.error("could not download file")},i.send()}function i(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function o(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,s=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(t,n,s){var a=r.URL||r.webkitURL,d=document.createElement("a");n=n||t.name||"download",d.download=n,d.rel="noopener","string"==typeof t?(d.href=t,d.origin===location.origin?o(d):i(d.href)?e(t,n,s):o(d,d.target="_blank")):(d.href=a.createObjectURL(t),setTimeout(function(){a.revokeObjectURL(d.href)},4e4),setTimeout(function(){o(d)},0))}:"msSaveOrOpenBlob"in navigator?function(t,n,r){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,r),n);else if(i(t))e(t,n,r);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout(function(){o(s)})}}:function(t,n,i,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,i);var a="application/octet-stream"===t.type,d=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||a&&d||s)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var t=l.result;t=c?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=t:location=t,o=null},l.readAsDataURL(t)}else{var u=r.URL||r.webkitURL,h=u.createObjectURL(t);o?o.location=h:location.href=h,o=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});r.saveAs=a.saveAs=a,t.exports=a})?i.apply(e,[]):i)||(t.exports=o)},4385:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},4702:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i='<div class="mb-4"> <h5 class="text-center">Авторизация</h5> </div> <form id="login-form" method="post" action="https://cdm.sumjest.ru/api/login"> <div class="form-group"> <label for="username" class="form-label">Имя пользователя</label> <input type="text" class="form-control" id="username" name="username" autocomplete="off" required/> </div> <div class="form-group mt-2"> <label for="password" class="form-label">Пароль</label> <input type="password" class="form-control" id="password" name="password" required/> </div> <div class="form-check mt-4"> <input id="hidden-mode" class="form-check-input" type="checkbox" name="hiddenMode"/> <label class="form-check-label" for="hidden-mode"> Только на один тест </label> </div> <div id="auth-error" class="form-control-sm text-danger my-1">Reason here.</div> <div class="d-flex flex-column mt-2"> <div class="btn-group" role="group" id="login-btn-group"> <button id="login" type="submit" class="btn btn-primary"> <span>Войти</span> <div class="spinner-border spinner-border-sm" role="status"> <span class="sr-only">Loading...</span> </div> </button> <button class="btn btn-outline-primary" type="button" id="qrLoginButton"> <i class="fa-solid fa-qrcode"></i> </button> </div> </div> <div class="d-flex flex-column mt-2"> <button id="back" type="submit" class="btn btn-outline-secondary">Назад</button> </div> </form> '},5699:(t,e)=>{"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.isNavigationEvent=e.NavigationEvent=e.PageTag=void 0,(n=e.PageTag||(e.PageTag={})).Main="main-page",n.Login="login-page",n.Settings="settings-page",n.QrPage="qr-page",n.DiagnosticPage="diagnostic-page";class i{}e.NavigationEvent=i,i.Topic="popup-navigation-event",i.OpenPage=class extends i{constructor(t){super(),this.page=t}},e.isNavigationEvent=function(t){return t instanceof i}},5730:(t,e,n)=>{"use strict";t.exports=n.p+"74d85fb11d53487d88e3.png"},5872:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i='<div class="mb-3"> <h5 class="text-center">Диагностика</h5> </div> <p><small>Ниже вы можете скачать диагностический файл SyncShare.</small></p> <p> <small>Файл лучше скачивать <b>во время решения теста</b>.</small> </p> <p> <small> Если вы наблюдаете проблемы в работе расширения, то свяжитесь, пожалуйста, с нами и предоставьте данный файл – поможем, чем сможем :) </small> </p> <div class="d-flex flex-column mt-3"> <button id="download-diagnostic" type="submit" class="btn btn-primary"> <span>Скачать</span> <div class="spinner-border spinner-border-sm" role="status"> <span class="sr-only">Loading...</span> </div> </button> </div> <div class="d-flex flex-column mt-2"> <button id="back" type="submit" class="btn btn-outline-secondary">Назад</button> </div> '},6226:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AccountServiceContent=void 0;const i=n(6539),o=n(2159);e.AccountServiceContent=class{constructor(t){this.bus=t}async getUserData(){return(0,o.toResult)(await this.bus.publishToBackground(i.AccountServiceEvent.GetUserData)).getOrThrow()}async isBenefitsAvailable(t){return(0,o.toResult)(await this.bus.publishToBackground(i.AccountServiceEvent.IsBenefitsAvailable,t)).getOrThrow()}}},6884:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MainPage=void 0;const o=n(8376),r=i(n(7194)),s=n(254),a=n(2432),d=n(5699),c=n(2159),l=n(7709);class u{constructor(t){this.root=t,this.loginButton=(0,s.checkNotNull)(t.querySelector("#login"),"Could not login button"),this.logoutButton=(0,s.checkNotNull)(t.querySelector("#logout"),"Could not find logout button"),this.settingsButton=(0,s.checkNotNull)(t.querySelector("#settings"),"Could not find settings button"),this.privacyPolicyButton=(0,s.checkNotNull)(t.querySelector("#privacy"),"Could not find privacy policy button"),this.usernameSpan=(0,s.checkNotNull)(t.querySelector("#username"),"Could not find username span"),this.usernameContainer=(0,s.checkNotNull)(t.querySelector("#username-container"),"Could not find username container"),this.statusHeading=(0,s.checkNotNull)(t.querySelector("#status"),"Could not find status heading"),this.profileButton=(0,s.checkNotNull)(t.querySelector("#profile"),"Could not find profile button"),this.diagnosticButton=(0,s.checkNotNull)(t.querySelector("#diagnostic"),"Could not find diagnostic"),this.contactButton=(0,s.checkNotNull)(t.querySelector("#contact"),"Could not find contact button"),this.docsButton=(0,s.checkNotNull)(t.querySelector("#docs"),"Could not find docs button"),this.registrationLink=(0,s.checkNotNull)(t.querySelector("#registration-link"),"Could not find registration link")}static inflate(){const t=document.createElement("div");return t.id=this.LAYOUT_ID,t.innerHTML=r.default,t.hidden=!0,new u(t)}}u.LAYOUT_ID="main-page";class h extends o.BasePage{constructor(t,e,n){super(t),this.accountService=e,this.authService=n,this.binding=u.inflate(),this.popup=new a.PopupBinding,this.binding.profileButton.addEventListener("click",()=>{this.onClickProfileButton()}),this.binding.docsButton.addEventListener("click",()=>{this.onClickDocsButton()}),this.binding.diagnosticButton.addEventListener("click",()=>{this.onClickDiagnosticButton()}),this.binding.contactButton.addEventListener("click",()=>{this.onClickContactButton()}),this.binding.settingsButton.addEventListener("click",()=>{this.onClickSettingsButton()}),this.binding.privacyPolicyButton.addEventListener("click",()=>{this.onClickPrivacyPolicyButton()}),this.binding.logoutButton.addEventListener("click",()=>{this.onClickLogoutButton()}),this.binding.loginButton.addEventListener("click",()=>{this.onClickLoginButton()}),this.binding.registrationLink.addEventListener("click",()=>{this.onClickRegistrationButton()}),this.binding.statusHeading.addEventListener("click",()=>{this.onClickStatus()})}show(){document.querySelector("#"+u.LAYOUT_ID)||this.popup.container.prepend(this.binding.root),this.render().then(),this.binding.root.hidden=!1}hide(){this.binding.root.hidden=!0}async render(){const t=(await(0,c.runCatching)(()=>this.authService.getUserData())).getOrNull();null!=t?(this.binding.usernameContainer.classList.remove("hidden"),this.binding.usernameSpan.innerText=t.username,this.binding.logoutButton.hidden=!1,this.binding.loginButton.hidden=!0,this.binding.registrationLink.hidden=!0):(this.binding.usernameContainer.classList.add("hidden"),this.binding.logoutButton.hidden=!0,this.binding.loginButton.hidden=!1,this.binding.registrationLink.hidden=!1);const e=2===t?.plan;this.binding.statusHeading.innerText=e?"Расширенная версия":"Базовая версия"}onClickProfileButton(){window.open("https://syncshare.naloaty.me/account-manage","_blank")?.focus(),window.close()}onClickDocsButton(){window.open("https://syncshare.naloaty.me/docs","_blank")?.focus(),window.close()}onClickRegistrationButton(){window.open("https://syncshare.naloaty.me/account-register","_blank")?.focus(),window.close()}onClickStatus(){window.open("https://syncshare.naloaty.me/account-help","_blank")?.focus(),window.close()}onClickContactButton(){navigator.clipboard.writeText("syncshare.ext@gmail.com"),alert("Электропочта скопирована в буффер обмена."),window.close()}onClickDiagnosticButton(){this.navigateTo(d.PageTag.DiagnosticPage)}onClickSettingsButton(){this.navigateTo(d.PageTag.Settings)}onClickPrivacyPolicyButton(){window.close(),(0,l.openPrivacyPolicyConsentPage)()}onClickLogoutButton(){this.authService.logout().then(()=>{this.render().then()})}onClickLoginButton(){this.navigateTo(d.PageTag.Login)}}e.MainPage=h},7150:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i='<div class="mb-4"> <h5 class="text-center">Настройки</h5> </div> <div class="card mt-4 p-3"> <div> <label for="widget-toggle-hotkey" class="form-label">Скрыть/показать палочку</label> <div class="input-group"> <input id="widget-toggle-hotkey" readonly="readonly" type="text" class="form-control" value="esc" aria-label="Hotkey" aria-describedby="w-toggle-hotkey"/> </div> </div> <div class="form-check mt-3"> <input id="widget-toggle-double-click" class="form-check-input" type="checkbox" value=""/> <label class="form-check-label" for="widget-toggle-double-click"> Двойным кликом </label> </div> <div class="form-check mt-1"> <input id="hide-widget-by-default" class="form-check-input" type="checkbox" value=""/> <label class="form-check-label" for="hide-widget-by-default"> Скрыта по умолчанию </label> </div> </div> <div id="other-section" class="card mt-2 px-3 py-2"> <div class="form-check"> <input id="hide-notifications" class="form-check-input" type="checkbox" value=""/> <label class="form-check-label" for="hide-notifications"> Отключить уведомления </label> </div> </div> <div id="info-section" class="card mt-3"> <div class="d-flex flex-column"> <button id="docs" type="button" class="btn btn-sm btn-link">Документация</button> <button id="support" type="button" class="btn btn-sm btn-link">Поддержать проект</button> <button id="contact" type="button" class="btn btn-sm btn-link">syncshare.ext@gmail.com</button> </div> </div> <div class="d-flex flex-row-reverse mt-4"> <button id="save-settings" type="button" class="btn btn-primary">Сохранить</button> </div> <div class="d-flex flex-column mt-2"> <button type="button" class="btn btn-outline-secondary" id="back">Назад</button> </div> '},7194:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var i=n(4385),o=n.n(i),r=new URL(n(5730),n.b);const s='<div class="d-flex justify-content-between"> <div id="username-container" class="d-flex flex-row align-items-center text-secondary hidden"> <i class="fa-solid fa-user-astronaut me-2"></i> <span id="username">naloaty</span> </div> <div class="dropdown"> <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false"> <i class="fa-solid fa-bars"></i> </button> <ul class="dropdown-menu shadow-lg" aria-labelledby="dropdownMenuButton1"> <li><a id="settings" class="dropdown-item" href="#">Настройки</a></li> <li><a id="privacy" class="dropdown-item" href="#">Конфиденциальность</a></li> <li> <hr class="dropdown-divider"/> </li> <li><a id="diagnostic" class="dropdown-item" href="#">Диагностика</a></li> <li><a id="docs" class="dropdown-item" href="#">Документация</a></li> <li><a id="contact" class="dropdown-item" href="#">Связь с разработчиками</a></li> </ul> </div> </div> <div class="d-flex justify-content-center mt-4"> <img id="logo" src="'+o()(r)+'" alt="Logo"/> </div> <div class="d-flex flex-column align-items-center mt-3 pb-2"> <h5>SyncShare</h5> <a id="status" href="#" class="link-dark link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover"> Базовая версия </a> </div> <div class="d-flex flex-column mt-4"> <button id="login" type="button" class="btn btn-primary">Войти</button> <button id="logout" type="button" class="btn btn-outline-danger" hidden>Выйти</button> </div> <div class="d-flex flex-column mt-2"> <div id="profile" class="btn btn-outline-secondary"> <span class="me-1">Личный кабинет</span> <i class="fa-solid fa-arrow-up-right-from-square text-icon"></i> </div> </div> <div class="d-flex justify-content-center mt-3"> <a id="registration-link" href="#" class="btn btn-sm btn-link text-secondary"> Нет аккаунта? Регистрация тут! </a> </div> '},7283:function(t){var e;e=()=>(()=>{var t={873:(t,e)=>{var n,i,o=function(){var t=function(t,e){var n=t,i=s[e],o=null,r=0,d=null,w=[],v={},m=function(t,e){o=function(t){for(var e=new Array(t),n=0;n<t;n+=1){e[n]=new Array(t);for(var i=0;i<t;i+=1)e[n][i]=null}return e}(r=4*n+17),y(0,0),y(r-7,0),y(0,r-7),k(),_(),C(t,e),n>=7&&S(t),null==d&&(d=B(n,i,w)),x(d,e)},y=function(t,e){for(var n=-1;n<=7;n+=1)if(!(t+n<=-1||r<=t+n))for(var i=-1;i<=7;i+=1)e+i<=-1||r<=e+i||(o[t+n][e+i]=0<=n&&n<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=i&&i<=4)},_=function(){for(var t=8;t<r-8;t+=1)null==o[t][6]&&(o[t][6]=t%2==0);for(var e=8;e<r-8;e+=1)null==o[6][e]&&(o[6][e]=e%2==0)},k=function(){for(var t=a.getPatternPosition(n),e=0;e<t.length;e+=1)for(var i=0;i<t.length;i+=1){var r=t[e],s=t[i];if(null==o[r][s])for(var d=-2;d<=2;d+=1)for(var c=-2;c<=2;c+=1)o[r+d][s+c]=-2==d||2==d||-2==c||2==c||0==d&&0==c}},S=function(t){for(var e=a.getBCHTypeNumber(n),i=0;i<18;i+=1){var s=!t&&1==(e>>i&1);o[Math.floor(i/3)][i%3+r-8-3]=s}for(i=0;i<18;i+=1)s=!t&&1==(e>>i&1),o[i%3+r-8-3][Math.floor(i/3)]=s},C=function(t,e){for(var n=i<<3|e,s=a.getBCHTypeInfo(n),d=0;d<15;d+=1){var c=!t&&1==(s>>d&1);d<6?o[d][8]=c:d<8?o[d+1][8]=c:o[r-15+d][8]=c}for(d=0;d<15;d+=1)c=!t&&1==(s>>d&1),d<8?o[8][r-d-1]=c:d<9?o[8][15-d-1+1]=c:o[8][15-d-1]=c;o[r-8][8]=!t},x=function(t,e){for(var n=-1,i=r-1,s=7,d=0,c=a.getMaskFunction(e),l=r-1;l>0;l-=2)for(6==l&&(l-=1);;){for(var u=0;u<2;u+=1)if(null==o[i][l-u]){var h=!1;d<t.length&&(h=1==(t[d]>>>s&1)),c(i,l-u)&&(h=!h),o[i][l-u]=h,-1==(s-=1)&&(d+=1,s=7)}if((i+=n)<0||r<=i){i-=n,n=-n;break}}},B=function(t,e,n){for(var i=l.getRSBlocks(t,e),o=u(),r=0;r<n.length;r+=1){var s=n[r];o.put(s.getMode(),4),o.put(s.getLength(),a.getLengthInBits(s.getMode(),t)),s.write(o)}var d=0;for(r=0;r<i.length;r+=1)d+=i[r].dataCount;if(o.getLengthInBits()>8*d)throw"code length overflow. ("+o.getLengthInBits()+">"+8*d+")";for(o.getLengthInBits()+4<=8*d&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*d||(o.put(236,8),o.getLengthInBits()>=8*d));)o.put(17,8);return function(t,e){for(var n=0,i=0,o=0,r=new Array(e.length),s=new Array(e.length),d=0;d<e.length;d+=1){var l=e[d].dataCount,u=e[d].totalCount-l;i=Math.max(i,l),o=Math.max(o,u),r[d]=new Array(l);for(var h=0;h<r[d].length;h+=1)r[d][h]=255&t.getBuffer()[h+n];n+=l;var g=a.getErrorCorrectPolynomial(u),f=c(r[d],g.getLength()-1).mod(g);for(s[d]=new Array(g.getLength()-1),h=0;h<s[d].length;h+=1){var p=h+f.getLength()-s[d].length;s[d][h]=p>=0?f.getAt(p):0}}var w=0;for(h=0;h<e.length;h+=1)w+=e[h].totalCount;var v=new Array(w),b=0;for(h=0;h<i;h+=1)for(d=0;d<e.length;d+=1)h<r[d].length&&(v[b]=r[d][h],b+=1);for(h=0;h<o;h+=1)for(d=0;d<e.length;d+=1)h<s[d].length&&(v[b]=s[d][h],b+=1);return v}(o,i)};v.addData=function(t,e){var n=null;switch(e=e||"Byte"){case"Numeric":n=h(t);break;case"Alphanumeric":n=g(t);break;case"Byte":n=f(t);break;case"Kanji":n=p(t);break;default:throw"mode:"+e}w.push(n),d=null},v.isDark=function(t,e){if(t<0||r<=t||e<0||r<=e)throw t+","+e;return o[t][e]},v.getModuleCount=function(){return r},v.make=function(){if(n<1){for(var t=1;t<40;t++){for(var e=l.getRSBlocks(t,i),o=u(),r=0;r<w.length;r++){var s=w[r];o.put(s.getMode(),4),o.put(s.getLength(),a.getLengthInBits(s.getMode(),t)),s.write(o)}var d=0;for(r=0;r<e.length;r++)d+=e[r].dataCount;if(o.getLengthInBits()<=8*d)break}n=t}m(!1,function(){for(var t=0,e=0,n=0;n<8;n+=1){m(!0,n);var i=a.getLostPoint(v);(0==n||t>i)&&(t=i,e=n)}return e}())},v.createTableTag=function(t,e){t=t||2;var n="";n+='<table style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: "+(e=void 0===e?4*t:e)+"px;",n+='">',n+="<tbody>";for(var i=0;i<v.getModuleCount();i+=1){n+="<tr>";for(var o=0;o<v.getModuleCount();o+=1)n+='<td style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: 0px;",n+=" width: "+t+"px;",n+=" height: "+t+"px;",n+=" background-color: ",n+=v.isDark(i,o)?"#000000":"#ffffff",n+=";",n+='"/>';n+="</tr>"}return(n+="</tbody>")+"</table>"},v.createSvgTag=function(t,e,n,i){var o={};"object"==typeof arguments[0]&&(t=(o=arguments[0]).cellSize,e=o.margin,n=o.alt,i=o.title),t=t||2,e=void 0===e?4*t:e,(n="string"==typeof n?{text:n}:n||{}).text=n.text||null,n.id=n.text?n.id||"qrcode-description":null,(i="string"==typeof i?{text:i}:i||{}).text=i.text||null,i.id=i.text?i.id||"qrcode-title":null;var r,s,a,d,c=v.getModuleCount()*t+2*e,l="";for(d="l"+t+",0 0,"+t+" -"+t+",0 0,-"+t+"z ",l+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',l+=o.scalable?"":' width="'+c+'px" height="'+c+'px"',l+=' viewBox="0 0 '+c+" "+c+'" ',l+=' preserveAspectRatio="xMinYMin meet"',l+=i.text||n.text?' role="img" aria-labelledby="'+M([i.id,n.id].join(" ").trim())+'"':"",l+=">",l+=i.text?'<title id="'+M(i.id)+'">'+M(i.text)+"</title>":"",l+=n.text?'<description id="'+M(n.id)+'">'+M(n.text)+"</description>":"",l+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',l+='<path d="',s=0;s<v.getModuleCount();s+=1)for(a=s*t+e,r=0;r<v.getModuleCount();r+=1)v.isDark(s,r)&&(l+="M"+(r*t+e)+","+a+d);return(l+='" stroke="transparent" fill="black"/>')+"</svg>"},v.createDataURL=function(t,e){t=t||2,e=void 0===e?4*t:e;var n=v.getModuleCount()*t+2*e,i=e,o=n-e;return b(n,n,function(e,n){if(i<=e&&e<o&&i<=n&&n<o){var r=Math.floor((e-i)/t),s=Math.floor((n-i)/t);return v.isDark(s,r)?0:1}return 1})},v.createImgTag=function(t,e,n){t=t||2,e=void 0===e?4*t:e;var i=v.getModuleCount()*t+2*e,o="";return o+="<img",o+=' src="',o+=v.createDataURL(t,e),o+='"',o+=' width="',o+=i,o+='"',o+=' height="',o+=i,o+='"',n&&(o+=' alt="',o+=M(n),o+='"'),o+"/>"};var M=function(t){for(var e="",n=0;n<t.length;n+=1){var i=t.charAt(n);switch(i){case"<":e+="&lt;";break;case">":e+="&gt;";break;case"&":e+="&amp;";break;case'"':e+="&quot;";break;default:e+=i}}return e};return v.createASCII=function(t,e){if((t=t||1)<2)return function(t){t=void 0===t?2:t;var e,n,i,o,r,s=1*v.getModuleCount()+2*t,a=t,d=s-t,c={"██":"█","█ ":"▀"," █":"▄","  ":" "},l={"██":"▀","█ ":"▀"," █":" ","  ":" "},u="";for(e=0;e<s;e+=2){for(i=Math.floor((e-a)/1),o=Math.floor((e+1-a)/1),n=0;n<s;n+=1)r="█",a<=n&&n<d&&a<=e&&e<d&&v.isDark(i,Math.floor((n-a)/1))&&(r=" "),a<=n&&n<d&&a<=e+1&&e+1<d&&v.isDark(o,Math.floor((n-a)/1))?r+=" ":r+="█",u+=t<1&&e+1>=d?l[r]:c[r];u+="\n"}return s%2&&t>0?u.substring(0,u.length-s-1)+Array(s+1).join("▀"):u.substring(0,u.length-1)}(e);t-=1,e=void 0===e?2*t:e;var n,i,o,r,s=v.getModuleCount()*t+2*e,a=e,d=s-e,c=Array(t+1).join("██"),l=Array(t+1).join("  "),u="",h="";for(n=0;n<s;n+=1){for(o=Math.floor((n-a)/t),h="",i=0;i<s;i+=1)r=1,a<=i&&i<d&&a<=n&&n<d&&v.isDark(o,Math.floor((i-a)/t))&&(r=0),h+=r?c:l;for(o=0;o<t;o+=1)u+=h+"\n"}return u.substring(0,u.length-1)},v.renderTo2dContext=function(t,e){e=e||2;for(var n=v.getModuleCount(),i=0;i<n;i++)for(var o=0;o<n;o++)t.fillStyle=v.isDark(i,o)?"black":"white",t.fillRect(i*e,o*e,e,e)},v};t.stringToBytes=(t.stringToBytesFuncs={default:function(t){for(var e=[],n=0;n<t.length;n+=1){var i=t.charCodeAt(n);e.push(255&i)}return e}}).default,t.createStringToBytes=function(t,e){var n=function(){for(var n=v(t),i=function(){var t=n.read();if(-1==t)throw"eof";return t},o=0,r={};;){var s=n.read();if(-1==s)break;var a=i(),d=i()<<8|i();r[String.fromCharCode(s<<8|a)]=d,o+=1}if(o!=e)throw o+" != "+e;return r}(),i="?".charCodeAt(0);return function(t){for(var e=[],o=0;o<t.length;o+=1){var r=t.charCodeAt(o);if(r<128)e.push(r);else{var s=n[t.charAt(o)];"number"==typeof s?(255&s)==s?e.push(s):(e.push(s>>>8),e.push(255&s)):e.push(i)}}return e}};var e,n,i,o,r,s={L:1,M:0,Q:3,H:2},a=(e=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],n=1335,i=7973,r=function(t){for(var e=0;0!=t;)e+=1,t>>>=1;return e},(o={}).getBCHTypeInfo=function(t){for(var e=t<<10;r(e)-r(n)>=0;)e^=n<<r(e)-r(n);return 21522^(t<<10|e)},o.getBCHTypeNumber=function(t){for(var e=t<<12;r(e)-r(i)>=0;)e^=i<<r(e)-r(i);return t<<12|e},o.getPatternPosition=function(t){return e[t-1]},o.getMaskFunction=function(t){switch(t){case 0:return function(t,e){return(t+e)%2==0};case 1:return function(t,e){return t%2==0};case 2:return function(t,e){return e%3==0};case 3:return function(t,e){return(t+e)%3==0};case 4:return function(t,e){return(Math.floor(t/2)+Math.floor(e/3))%2==0};case 5:return function(t,e){return t*e%2+t*e%3==0};case 6:return function(t,e){return(t*e%2+t*e%3)%2==0};case 7:return function(t,e){return(t*e%3+(t+e)%2)%2==0};default:throw"bad maskPattern:"+t}},o.getErrorCorrectPolynomial=function(t){for(var e=c([1],0),n=0;n<t;n+=1)e=e.multiply(c([1,d.gexp(n)],0));return e},o.getLengthInBits=function(t,e){if(1<=e&&e<10)switch(t){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+t}else if(e<27)switch(t){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+t}else{if(!(e<41))throw"type:"+e;switch(t){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+t}}},o.getLostPoint=function(t){for(var e=t.getModuleCount(),n=0,i=0;i<e;i+=1)for(var o=0;o<e;o+=1){for(var r=0,s=t.isDark(i,o),a=-1;a<=1;a+=1)if(!(i+a<0||e<=i+a))for(var d=-1;d<=1;d+=1)o+d<0||e<=o+d||0==a&&0==d||s==t.isDark(i+a,o+d)&&(r+=1);r>5&&(n+=3+r-5)}for(i=0;i<e-1;i+=1)for(o=0;o<e-1;o+=1){var c=0;t.isDark(i,o)&&(c+=1),t.isDark(i+1,o)&&(c+=1),t.isDark(i,o+1)&&(c+=1),t.isDark(i+1,o+1)&&(c+=1),0!=c&&4!=c||(n+=3)}for(i=0;i<e;i+=1)for(o=0;o<e-6;o+=1)t.isDark(i,o)&&!t.isDark(i,o+1)&&t.isDark(i,o+2)&&t.isDark(i,o+3)&&t.isDark(i,o+4)&&!t.isDark(i,o+5)&&t.isDark(i,o+6)&&(n+=40);for(o=0;o<e;o+=1)for(i=0;i<e-6;i+=1)t.isDark(i,o)&&!t.isDark(i+1,o)&&t.isDark(i+2,o)&&t.isDark(i+3,o)&&t.isDark(i+4,o)&&!t.isDark(i+5,o)&&t.isDark(i+6,o)&&(n+=40);var l=0;for(o=0;o<e;o+=1)for(i=0;i<e;i+=1)t.isDark(i,o)&&(l+=1);return n+Math.abs(100*l/e/e-50)/5*10},o),d=function(){for(var t=new Array(256),e=new Array(256),n=0;n<8;n+=1)t[n]=1<<n;for(n=8;n<256;n+=1)t[n]=t[n-4]^t[n-5]^t[n-6]^t[n-8];for(n=0;n<255;n+=1)e[t[n]]=n;return{glog:function(t){if(t<1)throw"glog("+t+")";return e[t]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return t[e]}}}();function c(t,e){if(void 0===t.length)throw t.length+"/"+e;var n=function(){for(var n=0;n<t.length&&0==t[n];)n+=1;for(var i=new Array(t.length-n+e),o=0;o<t.length-n;o+=1)i[o]=t[o+n];return i}(),i={getAt:function(t){return n[t]},getLength:function(){return n.length},multiply:function(t){for(var e=new Array(i.getLength()+t.getLength()-1),n=0;n<i.getLength();n+=1)for(var o=0;o<t.getLength();o+=1)e[n+o]^=d.gexp(d.glog(i.getAt(n))+d.glog(t.getAt(o)));return c(e,0)},mod:function(t){if(i.getLength()-t.getLength()<0)return i;for(var e=d.glog(i.getAt(0))-d.glog(t.getAt(0)),n=new Array(i.getLength()),o=0;o<i.getLength();o+=1)n[o]=i.getAt(o);for(o=0;o<t.getLength();o+=1)n[o]^=d.gexp(d.glog(t.getAt(o))+e);return c(n,0).mod(t)}};return i}var l=function(){var t=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e=function(t,e){var n={};return n.totalCount=t,n.dataCount=e,n},n={getRSBlocks:function(n,i){var o=function(e,n){switch(n){case s.L:return t[4*(e-1)+0];case s.M:return t[4*(e-1)+1];case s.Q:return t[4*(e-1)+2];case s.H:return t[4*(e-1)+3];default:return}}(n,i);if(void 0===o)throw"bad rs block @ typeNumber:"+n+"/errorCorrectionLevel:"+i;for(var r=o.length/3,a=[],d=0;d<r;d+=1)for(var c=o[3*d+0],l=o[3*d+1],u=o[3*d+2],h=0;h<c;h+=1)a.push(e(l,u));return a}};return n}(),u=function(){var t=[],e=0,n={getBuffer:function(){return t},getAt:function(e){var n=Math.floor(e/8);return 1==(t[n]>>>7-e%8&1)},put:function(t,e){for(var i=0;i<e;i+=1)n.putBit(1==(t>>>e-i-1&1))},getLengthInBits:function(){return e},putBit:function(n){var i=Math.floor(e/8);t.length<=i&&t.push(0),n&&(t[i]|=128>>>e%8),e+=1}};return n},h=function(t){var e=t,n={getMode:function(){return 1},getLength:function(t){return e.length},write:function(t){for(var n=e,o=0;o+2<n.length;)t.put(i(n.substring(o,o+3)),10),o+=3;o<n.length&&(n.length-o==1?t.put(i(n.substring(o,o+1)),4):n.length-o==2&&t.put(i(n.substring(o,o+2)),7))}},i=function(t){for(var e=0,n=0;n<t.length;n+=1)e=10*e+o(t.charAt(n));return e},o=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+t};return n},g=function(t){var e=t,n={getMode:function(){return 2},getLength:function(t){return e.length},write:function(t){for(var n=e,o=0;o+1<n.length;)t.put(45*i(n.charAt(o))+i(n.charAt(o+1)),11),o+=2;o<n.length&&t.put(i(n.charAt(o)),6)}},i=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);if("A"<=t&&t<="Z")return t.charCodeAt(0)-"A".charCodeAt(0)+10;switch(t){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+t}};return n},f=function(e){var n=t.stringToBytes(e);return{getMode:function(){return 4},getLength:function(t){return n.length},write:function(t){for(var e=0;e<n.length;e+=1)t.put(n[e],8)}}},p=function(e){var n=t.stringToBytesFuncs.SJIS;if(!n)throw"sjis not supported.";!function(){var t=n("友");if(2!=t.length||38726!=(t[0]<<8|t[1]))throw"sjis not supported."}();var i=n(e),o={getMode:function(){return 8},getLength:function(t){return~~(i.length/2)},write:function(t){for(var e=i,n=0;n+1<e.length;){var o=(255&e[n])<<8|255&e[n+1];if(33088<=o&&o<=40956)o-=33088;else{if(!(57408<=o&&o<=60351))throw"illegal char at "+(n+1)+"/"+o;o-=49472}o=192*(o>>>8&255)+(255&o),t.put(o,13),n+=2}if(n<e.length)throw"illegal char at "+(n+1)}};return o},w=function(){var t=[],e={writeByte:function(e){t.push(255&e)},writeShort:function(t){e.writeByte(t),e.writeByte(t>>>8)},writeBytes:function(t,n,i){n=n||0,i=i||t.length;for(var o=0;o<i;o+=1)e.writeByte(t[o+n])},writeString:function(t){for(var n=0;n<t.length;n+=1)e.writeByte(t.charCodeAt(n))},toByteArray:function(){return t},toString:function(){var e="";e+="[";for(var n=0;n<t.length;n+=1)n>0&&(e+=","),e+=t[n];return e+"]"}};return e},v=function(t){var e=t,n=0,i=0,o=0,r={read:function(){for(;o<8;){if(n>=e.length){if(0==o)return-1;throw"unexpected end of file./"+o}var t=e.charAt(n);if(n+=1,"="==t)return o=0,-1;t.match(/^\s$/)||(i=i<<6|s(t.charCodeAt(0)),o+=6)}var r=i>>>o-8&255;return o-=8,r}},s=function(t){if(65<=t&&t<=90)return t-65;if(97<=t&&t<=122)return t-97+26;if(48<=t&&t<=57)return t-48+52;if(43==t)return 62;if(47==t)return 63;throw"c:"+t};return r},b=function(t,e,n){for(var i=function(t,e){var n=t,i=e,o=new Array(t*e),r={setPixel:function(t,e,i){o[e*n+t]=i},write:function(t){t.writeString("GIF87a"),t.writeShort(n),t.writeShort(i),t.writeByte(128),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(255),t.writeByte(255),t.writeByte(255),t.writeString(","),t.writeShort(0),t.writeShort(0),t.writeShort(n),t.writeShort(i),t.writeByte(0);var e=s(2);t.writeByte(2);for(var o=0;e.length-o>255;)t.writeByte(255),t.writeBytes(e,o,255),o+=255;t.writeByte(e.length-o),t.writeBytes(e,o,e.length-o),t.writeByte(0),t.writeString(";")}},s=function(t){for(var e=1<<t,n=1+(1<<t),i=t+1,r=a(),s=0;s<e;s+=1)r.add(String.fromCharCode(s));r.add(String.fromCharCode(e)),r.add(String.fromCharCode(n));var d,c,l,u=w(),h=(d=u,c=0,l=0,{write:function(t,e){if(t>>>e!=0)throw"length over";for(;c+e>=8;)d.writeByte(255&(t<<c|l)),e-=8-c,t>>>=8-c,l=0,c=0;l|=t<<c,c+=e},flush:function(){c>0&&d.writeByte(l)}});h.write(e,i);var g=0,f=String.fromCharCode(o[g]);for(g+=1;g<o.length;){var p=String.fromCharCode(o[g]);g+=1,r.contains(f+p)?f+=p:(h.write(r.indexOf(f),i),r.size()<4095&&(r.size()==1<<i&&(i+=1),r.add(f+p)),f=p)}return h.write(r.indexOf(f),i),h.write(n,i),h.flush(),u.toByteArray()},a=function(){var t={},e=0,n={add:function(i){if(n.contains(i))throw"dup key:"+i;t[i]=e,e+=1},size:function(){return e},indexOf:function(e){return t[e]},contains:function(e){return void 0!==t[e]}};return n};return r}(t,e),o=0;o<e;o+=1)for(var r=0;r<t;r+=1)i.setPixel(r,o,n(r,o));var s=w();i.write(s);for(var a=function(){var t=0,e=0,n=0,i="",o={},r=function(t){i+=String.fromCharCode(s(63&t))},s=function(t){if(t<0);else{if(t<26)return 65+t;if(t<52)return t-26+97;if(t<62)return t-52+48;if(62==t)return 43;if(63==t)return 47}throw"n:"+t};return o.writeByte=function(i){for(t=t<<8|255&i,e+=8,n+=1;e>=6;)r(t>>>e-6),e-=6},o.flush=function(){if(e>0&&(r(t<<6-e),t=0,e=0),n%3!=0)for(var o=3-n%3,s=0;s<o;s+=1)i+="="},o.toString=function(){return i},o}(),d=s.toByteArray(),c=0;c<d.length;c+=1)a.writeByte(d[c]);return a.flush(),"data:image/gif;base64,"+a};return t}();o.stringToBytesFuncs["UTF-8"]=function(t){return function(t){for(var e=[],n=0;n<t.length;n++){var i=t.charCodeAt(n);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(n++,i=65536+((1023&i)<<10|1023&t.charCodeAt(n)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return e}(t)},void 0===(i="function"==typeof(n=function(){return o})?n.apply(e,[]):n)||(t.exports=i)}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={exports:{}};return t[i](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var i={};return(()=>{"use strict";n.d(i,{default:()=>M});const t=t=>!!t&&"object"==typeof t&&!Array.isArray(t);function e(n,...i){if(!i.length)return n;const o=i.shift();return void 0!==o&&t(n)&&t(o)?(n=Object.assign({},n),Object.keys(o).forEach(i=>{const r=n[i],s=o[i];Array.isArray(r)&&Array.isArray(s)?n[i]=s:t(r)&&t(s)?n[i]=e(Object.assign({},r),s):n[i]=s}),e(n,...i)):n}function o(t,e){const n=document.createElement("a");n.download=e,n.href=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}const r={L:.07,M:.15,Q:.25,H:.3};class s{constructor({svg:t,type:e,window:n}){this._svg=t,this._type=e,this._window=n}draw(t,e,n,i){let o;switch(this._type){case"dots":o=this._drawDot;break;case"classy":o=this._drawClassy;break;case"classy-rounded":o=this._drawClassyRounded;break;case"rounded":o=this._drawRounded;break;case"extra-rounded":o=this._drawExtraRounded;break;default:o=this._drawSquare}o.call(this,{x:t,y:e,size:n,getNeighbor:i})}_rotateFigure({x:t,y:e,size:n,rotation:i=0,draw:o}){var r;const s=t+n/2,a=e+n/2;o(),null===(r=this._element)||void 0===r||r.setAttribute("transform",`rotate(${180*i/Math.PI},${s},${a})`)}_basicDot(t){const{size:e,x:n,y:i}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(n+e/2)),this._element.setAttribute("cy",String(i+e/2)),this._element.setAttribute("r",String(e/2))}}))}_basicSquare(t){const{size:e,x:n,y:i}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(n)),this._element.setAttribute("y",String(i)),this._element.setAttribute("width",String(e)),this._element.setAttribute("height",String(e))}}))}_basicSideRounded(t){const{size:e,x:n,y:i}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${n} ${i}v ${e}h `+e/2+`a ${e/2} ${e/2}, 0, 0, 0, 0 ${-e}`)}}))}_basicCornerRounded(t){const{size:e,x:n,y:i}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${n} ${i}v ${e}h ${e}v `+-e/2+`a ${e/2} ${e/2}, 0, 0, 0, ${-e/2} ${-e/2}`)}}))}_basicCornerExtraRounded(t){const{size:e,x:n,y:i}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${n} ${i}v ${e}h ${e}a ${e} ${e}, 0, 0, 0, ${-e} ${-e}`)}}))}_basicCornersRounded(t){const{size:e,x:n,y:i}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${n} ${i}v `+e/2+`a ${e/2} ${e/2}, 0, 0, 0, ${e/2} ${e/2}h `+e/2+"v "+-e/2+`a ${e/2} ${e/2}, 0, 0, 0, ${-e/2} ${-e/2}`)}}))}_drawDot({x:t,y:e,size:n}){this._basicDot({x:t,y:e,size:n,rotation:0})}_drawSquare({x:t,y:e,size:n}){this._basicSquare({x:t,y:e,size:n,rotation:0})}_drawRounded({x:t,y:e,size:n,getNeighbor:i}){const o=i?+i(-1,0):0,r=i?+i(1,0):0,s=i?+i(0,-1):0,a=i?+i(0,1):0,d=o+r+s+a;if(0!==d)if(d>2||o&&r||s&&a)this._basicSquare({x:t,y:e,size:n,rotation:0});else{if(2===d){let i=0;return o&&s?i=Math.PI/2:s&&r?i=Math.PI:r&&a&&(i=-Math.PI/2),void this._basicCornerRounded({x:t,y:e,size:n,rotation:i})}if(1===d){let i=0;return s?i=Math.PI/2:r?i=Math.PI:a&&(i=-Math.PI/2),void this._basicSideRounded({x:t,y:e,size:n,rotation:i})}}else this._basicDot({x:t,y:e,size:n,rotation:0})}_drawExtraRounded({x:t,y:e,size:n,getNeighbor:i}){const o=i?+i(-1,0):0,r=i?+i(1,0):0,s=i?+i(0,-1):0,a=i?+i(0,1):0,d=o+r+s+a;if(0!==d)if(d>2||o&&r||s&&a)this._basicSquare({x:t,y:e,size:n,rotation:0});else{if(2===d){let i=0;return o&&s?i=Math.PI/2:s&&r?i=Math.PI:r&&a&&(i=-Math.PI/2),void this._basicCornerExtraRounded({x:t,y:e,size:n,rotation:i})}if(1===d){let i=0;return s?i=Math.PI/2:r?i=Math.PI:a&&(i=-Math.PI/2),void this._basicSideRounded({x:t,y:e,size:n,rotation:i})}}else this._basicDot({x:t,y:e,size:n,rotation:0})}_drawClassy({x:t,y:e,size:n,getNeighbor:i}){const o=i?+i(-1,0):0,r=i?+i(1,0):0,s=i?+i(0,-1):0,a=i?+i(0,1):0;0!==o+r+s+a?o||s?r||a?this._basicSquare({x:t,y:e,size:n,rotation:0}):this._basicCornerRounded({x:t,y:e,size:n,rotation:Math.PI/2}):this._basicCornerRounded({x:t,y:e,size:n,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:e,size:n,rotation:Math.PI/2})}_drawClassyRounded({x:t,y:e,size:n,getNeighbor:i}){const o=i?+i(-1,0):0,r=i?+i(1,0):0,s=i?+i(0,-1):0,a=i?+i(0,1):0;0!==o+r+s+a?o||s?r||a?this._basicSquare({x:t,y:e,size:n,rotation:0}):this._basicCornerExtraRounded({x:t,y:e,size:n,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:t,y:e,size:n,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:e,size:n,rotation:Math.PI/2})}}const a={dot:"dot",square:"square",extraRounded:"extra-rounded"},d=Object.values(a);class c{constructor({svg:t,type:e,window:n}){this._svg=t,this._type=e,this._window=n}draw(t,e,n,i){let o;switch(this._type){case a.square:o=this._drawSquare;break;case a.extraRounded:o=this._drawExtraRounded;break;default:o=this._drawDot}o.call(this,{x:t,y:e,size:n,rotation:i})}_rotateFigure({x:t,y:e,size:n,rotation:i=0,draw:o}){var r;const s=t+n/2,a=e+n/2;o(),null===(r=this._element)||void 0===r||r.setAttribute("transform",`rotate(${180*i/Math.PI},${s},${a})`)}_basicDot(t){const{size:e,x:n,y:i}=t,o=e/7;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${n+e/2} ${i}a ${e/2} ${e/2} 0 1 0 0.1 0zm 0 ${o}a ${e/2-o} ${e/2-o} 0 1 1 -0.1 0Z`)}}))}_basicSquare(t){const{size:e,x:n,y:i}=t,o=e/7;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${n} ${i}v ${e}h ${e}v `+-e+"z"+`M ${n+o} ${i+o}h `+(e-2*o)+"v "+(e-2*o)+"h "+(2*o-e)+"z")}}))}_basicExtraRounded(t){const{size:e,x:n,y:i}=t,o=e/7;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${n} ${i+2.5*o}v `+2*o+`a ${2.5*o} ${2.5*o}, 0, 0, 0, ${2.5*o} ${2.5*o}h `+2*o+`a ${2.5*o} ${2.5*o}, 0, 0, 0, ${2.5*o} ${2.5*-o}v `+-2*o+`a ${2.5*o} ${2.5*o}, 0, 0, 0, ${2.5*-o} ${2.5*-o}h `+-2*o+`a ${2.5*o} ${2.5*o}, 0, 0, 0, ${2.5*-o} ${2.5*o}`+`M ${n+2.5*o} ${i+o}h `+2*o+`a ${1.5*o} ${1.5*o}, 0, 0, 1, ${1.5*o} ${1.5*o}v `+2*o+`a ${1.5*o} ${1.5*o}, 0, 0, 1, ${1.5*-o} ${1.5*o}h `+-2*o+`a ${1.5*o} ${1.5*o}, 0, 0, 1, ${1.5*-o} ${1.5*-o}v `+-2*o+`a ${1.5*o} ${1.5*o}, 0, 0, 1, ${1.5*o} ${1.5*-o}`)}}))}_drawDot({x:t,y:e,size:n,rotation:i}){this._basicDot({x:t,y:e,size:n,rotation:i})}_drawSquare({x:t,y:e,size:n,rotation:i}){this._basicSquare({x:t,y:e,size:n,rotation:i})}_drawExtraRounded({x:t,y:e,size:n,rotation:i}){this._basicExtraRounded({x:t,y:e,size:n,rotation:i})}}const l={dot:"dot",square:"square"},u=Object.values(l);class h{constructor({svg:t,type:e,window:n}){this._svg=t,this._type=e,this._window=n}draw(t,e,n,i){let o;o=this._type===l.square?this._drawSquare:this._drawDot,o.call(this,{x:t,y:e,size:n,rotation:i})}_rotateFigure({x:t,y:e,size:n,rotation:i=0,draw:o}){var r;const s=t+n/2,a=e+n/2;o(),null===(r=this._element)||void 0===r||r.setAttribute("transform",`rotate(${180*i/Math.PI},${s},${a})`)}_basicDot(t){const{size:e,x:n,y:i}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(n+e/2)),this._element.setAttribute("cy",String(i+e/2)),this._element.setAttribute("r",String(e/2))}}))}_basicSquare(t){const{size:e,x:n,y:i}=t;this._rotateFigure(Object.assign(Object.assign({},t),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(n)),this._element.setAttribute("y",String(i)),this._element.setAttribute("width",String(e)),this._element.setAttribute("height",String(e))}}))}_drawDot({x:t,y:e,size:n,rotation:i}){this._basicDot({x:t,y:e,size:n,rotation:i})}_drawSquare({x:t,y:e,size:n,rotation:i}){this._basicSquare({x:t,y:e,size:n,rotation:i})}}const g="circle",f=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],p=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];class w{constructor(t,e){this._roundSize=t=>this._options.dotsOptions.roundSize?Math.floor(t):t,this._window=e,this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(t.width)),this._element.setAttribute("height",String(t.height)),this._element.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),t.dotsOptions.roundSize||this._element.setAttribute("shape-rendering","crispEdges"),this._element.setAttribute("viewBox",`0 0 ${t.width} ${t.height}`),this._defs=this._window.document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._imageUri=t.image,this._instanceId=w.instanceCount++,this._options=t}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}async drawQR(t){const e=t.getModuleCount(),n=Math.min(this._options.width,this._options.height)-2*this._options.margin,i=this._options.shape===g?n/Math.sqrt(2):n,o=this._roundSize(i/e);let s={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=t,this._options.image){if(await this.loadImage(),!this._image)return;const{imageOptions:t,qrOptions:n}=this._options,i=t.imageSize*r[n.errorCorrectionLevel],a=Math.floor(i*e*e);s=function({originalHeight:t,originalWidth:e,maxHiddenDots:n,maxHiddenAxisDots:i,dotSize:o}){const r={x:0,y:0},s={x:0,y:0};if(t<=0||e<=0||n<=0||o<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};const a=t/e;return r.x=Math.floor(Math.sqrt(n/a)),r.x<=0&&(r.x=1),i&&i<r.x&&(r.x=i),r.x%2==0&&r.x--,s.x=r.x*o,r.y=1+2*Math.ceil((r.x*a-1)/2),s.y=Math.round(s.x*a),(r.y*r.x>n||i&&i<r.y)&&(i&&i<r.y?(r.y=i,r.y%2==0&&r.x--):r.y-=2,s.y=r.y*o,r.x=1+2*Math.ceil((r.y/a-1)/2),s.x=Math.round(s.y/a)),{height:s.y,width:s.x,hideYDots:r.y,hideXDots:r.x}}({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:a,maxHiddenAxisDots:e-14,dotSize:o})}this.drawBackground(),this.drawDots((t,n)=>{var i,o,r,a,d,c;return!(this._options.imageOptions.hideBackgroundDots&&t>=(e-s.hideYDots)/2&&t<(e+s.hideYDots)/2&&n>=(e-s.hideXDots)/2&&n<(e+s.hideXDots)/2||(null===(i=f[t])||void 0===i?void 0:i[n])||(null===(o=f[t-e+7])||void 0===o?void 0:o[n])||(null===(r=f[t])||void 0===r?void 0:r[n-e+7])||(null===(a=p[t])||void 0===a?void 0:a[n])||(null===(d=p[t-e+7])||void 0===d?void 0:d[n])||(null===(c=p[t])||void 0===c?void 0:c[n-e+7]))}),this.drawCorners(),this._options.image&&await this.drawImage({width:s.width,height:s.height,count:e,dotSize:o})}drawBackground(){var t,e,n;const i=this._element,o=this._options;if(i){const i=null===(t=o.backgroundOptions)||void 0===t?void 0:t.gradient,r=null===(e=o.backgroundOptions)||void 0===e?void 0:e.color;let s=o.height,a=o.width;if(i||r){const t=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");this._backgroundClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._backgroundClipPath.setAttribute("id",`clip-path-background-color-${this._instanceId}`),this._defs.appendChild(this._backgroundClipPath),(null===(n=o.backgroundOptions)||void 0===n?void 0:n.round)&&(s=a=Math.min(o.width,o.height),t.setAttribute("rx",String(s/2*o.backgroundOptions.round))),t.setAttribute("x",String(this._roundSize((o.width-a)/2))),t.setAttribute("y",String(this._roundSize((o.height-s)/2))),t.setAttribute("width",String(a)),t.setAttribute("height",String(s)),this._backgroundClipPath.appendChild(t),this._createColor({options:i,color:r,additionalRotation:0,x:0,y:0,height:o.height,width:o.width,name:`background-color-${this._instanceId}`})}}}drawDots(t){var e,n;if(!this._qr)throw"QR code is not defined";const i=this._options,o=this._qr.getModuleCount();if(o>i.width||o>i.height)throw"The canvas is too small.";const r=Math.min(i.width,i.height)-2*i.margin,a=i.shape===g?r/Math.sqrt(2):r,d=this._roundSize(a/o),c=this._roundSize((i.width-o*d)/2),l=this._roundSize((i.height-o*d)/2),u=new s({svg:this._element,type:i.dotsOptions.type,window:this._window});this._dotsClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id",`clip-path-dot-color-${this._instanceId}`),this._defs.appendChild(this._dotsClipPath),this._createColor({options:null===(e=i.dotsOptions)||void 0===e?void 0:e.gradient,color:i.dotsOptions.color,additionalRotation:0,x:0,y:0,height:i.height,width:i.width,name:`dot-color-${this._instanceId}`});for(let e=0;e<o;e++)for(let i=0;i<o;i++)t&&!t(e,i)||(null===(n=this._qr)||void 0===n?void 0:n.isDark(e,i))&&(u.draw(c+i*d,l+e*d,d,(n,r)=>!(i+n<0||e+r<0||i+n>=o||e+r>=o)&&!(t&&!t(e+r,i+n))&&!!this._qr&&this._qr.isDark(e+r,i+n)),u._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(u._element));if(i.shape===g){const t=this._roundSize((r/d-o)/2),e=o+2*t,n=c-t*d,i=l-t*d,s=[],a=this._roundSize(e/2);for(let n=0;n<e;n++){s[n]=[];for(let i=0;i<e;i++)n>=t-1&&n<=e-t&&i>=t-1&&i<=e-t||Math.sqrt((n-a)*(n-a)+(i-a)*(i-a))>a?s[n][i]=0:s[n][i]=this._qr.isDark(i-2*t<0?i:i>=o?i-2*t:i-t,n-2*t<0?n:n>=o?n-2*t:n-t)?1:0}for(let t=0;t<e;t++)for(let o=0;o<e;o++)s[t][o]&&(u.draw(n+o*d,i+t*d,d,(e,n)=>{var i;return!!(null===(i=s[t+n])||void 0===i?void 0:i[o+e])}),u._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(u._element))}}drawCorners(){if(!this._qr)throw"QR code is not defined";const t=this._element,e=this._options;if(!t)throw"Element code is not defined";const n=this._qr.getModuleCount(),i=Math.min(e.width,e.height)-2*e.margin,o=e.shape===g?i/Math.sqrt(2):i,r=this._roundSize(o/n),a=7*r,l=3*r,w=this._roundSize((e.width-n*r)/2),v=this._roundSize((e.height-n*r)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([t,i,o])=>{var g,b,m,y,_,k,S,C,x,B,M,A,P,O;const D=w+t*r*(n-7),L=v+i*r*(n-7);let N=this._dotsClipPath,E=this._dotsClipPath;if(((null===(g=e.cornersSquareOptions)||void 0===g?void 0:g.gradient)||(null===(b=e.cornersSquareOptions)||void 0===b?void 0:b.color))&&(N=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),N.setAttribute("id",`clip-path-corners-square-color-${t}-${i}-${this._instanceId}`),this._defs.appendChild(N),this._cornersSquareClipPath=this._cornersDotClipPath=E=N,this._createColor({options:null===(m=e.cornersSquareOptions)||void 0===m?void 0:m.gradient,color:null===(y=e.cornersSquareOptions)||void 0===y?void 0:y.color,additionalRotation:o,x:D,y:L,height:a,width:a,name:`corners-square-color-${t}-${i}-${this._instanceId}`})),(null===(_=e.cornersSquareOptions)||void 0===_?void 0:_.type)&&d.includes(e.cornersSquareOptions.type)){const t=new c({svg:this._element,type:e.cornersSquareOptions.type,window:this._window});t.draw(D,L,a,o),t._element&&N&&N.appendChild(t._element)}else{const t=new s({svg:this._element,type:(null===(k=e.cornersSquareOptions)||void 0===k?void 0:k.type)||e.dotsOptions.type,window:this._window});for(let e=0;e<f.length;e++)for(let n=0;n<f[e].length;n++)(null===(S=f[e])||void 0===S?void 0:S[n])&&(t.draw(D+n*r,L+e*r,r,(t,i)=>{var o;return!!(null===(o=f[e+i])||void 0===o?void 0:o[n+t])}),t._element&&N&&N.appendChild(t._element))}if(((null===(C=e.cornersDotOptions)||void 0===C?void 0:C.gradient)||(null===(x=e.cornersDotOptions)||void 0===x?void 0:x.color))&&(E=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),E.setAttribute("id",`clip-path-corners-dot-color-${t}-${i}-${this._instanceId}`),this._defs.appendChild(E),this._cornersDotClipPath=E,this._createColor({options:null===(B=e.cornersDotOptions)||void 0===B?void 0:B.gradient,color:null===(M=e.cornersDotOptions)||void 0===M?void 0:M.color,additionalRotation:o,x:D+2*r,y:L+2*r,height:l,width:l,name:`corners-dot-color-${t}-${i}-${this._instanceId}`})),(null===(A=e.cornersDotOptions)||void 0===A?void 0:A.type)&&u.includes(e.cornersDotOptions.type)){const t=new h({svg:this._element,type:e.cornersDotOptions.type,window:this._window});t.draw(D+2*r,L+2*r,l,o),t._element&&E&&E.appendChild(t._element)}else{const t=new s({svg:this._element,type:(null===(P=e.cornersDotOptions)||void 0===P?void 0:P.type)||e.dotsOptions.type,window:this._window});for(let e=0;e<p.length;e++)for(let n=0;n<p[e].length;n++)(null===(O=p[e])||void 0===O?void 0:O[n])&&(t.draw(D+n*r,L+e*r,r,(t,i)=>{var o;return!!(null===(o=p[e+i])||void 0===o?void 0:o[n+t])}),t._element&&E&&E.appendChild(t._element))}})}loadImage(){return new Promise((t,e)=>{var n;const i=this._options;if(!i.image)return e("Image is not defined");if(null===(n=i.nodeCanvas)||void 0===n?void 0:n.loadImage)i.nodeCanvas.loadImage(i.image).then(e=>{var n,o;if(this._image=e,this._options.imageOptions.saveAsBlob){const t=null===(n=i.nodeCanvas)||void 0===n?void 0:n.createCanvas(this._image.width,this._image.height);null===(o=null==t?void 0:t.getContext("2d"))||void 0===o||o.drawImage(e,0,0),this._imageUri=null==t?void 0:t.toDataURL()}t()}).catch(e);else{const e=new this._window.Image;"string"==typeof i.imageOptions.crossOrigin&&(e.crossOrigin=i.imageOptions.crossOrigin),this._image=e,e.onload=async()=>{this._options.imageOptions.saveAsBlob&&(this._imageUri=await async function(t,e){return new Promise(n=>{const i=new e.XMLHttpRequest;i.onload=function(){const t=new e.FileReader;t.onloadend=function(){n(t.result)},t.readAsDataURL(i.response)},i.open("GET",t),i.responseType="blob",i.send()})}(i.image||"",this._window)),t()},e.src=i.image}})}async drawImage({width:t,height:e,count:n,dotSize:i}){const o=this._options,r=this._roundSize((o.width-n*i)/2),s=this._roundSize((o.height-n*i)/2),a=r+this._roundSize(o.imageOptions.margin+(n*i-t)/2),d=s+this._roundSize(o.imageOptions.margin+(n*i-e)/2),c=t-2*o.imageOptions.margin,l=e-2*o.imageOptions.margin,u=this._window.document.createElementNS("http://www.w3.org/2000/svg","image");u.setAttribute("href",this._imageUri||""),u.setAttribute("xlink:href",this._imageUri||""),u.setAttribute("x",String(a)),u.setAttribute("y",String(d)),u.setAttribute("width",`${c}px`),u.setAttribute("height",`${l}px`),this._element.appendChild(u)}_createColor({options:t,color:e,additionalRotation:n,x:i,y:o,height:r,width:s,name:a}){const d=s>r?s:r,c=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");if(c.setAttribute("x",String(i)),c.setAttribute("y",String(o)),c.setAttribute("height",String(r)),c.setAttribute("width",String(s)),c.setAttribute("clip-path",`url('#clip-path-${a}')`),t){let e;if("radial"===t.type)e=this._window.document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),e.setAttribute("id",a),e.setAttribute("gradientUnits","userSpaceOnUse"),e.setAttribute("fx",String(i+s/2)),e.setAttribute("fy",String(o+r/2)),e.setAttribute("cx",String(i+s/2)),e.setAttribute("cy",String(o+r/2)),e.setAttribute("r",String(d/2));else{const d=((t.rotation||0)+n)%(2*Math.PI),c=(d+2*Math.PI)%(2*Math.PI);let l=i+s/2,u=o+r/2,h=i+s/2,g=o+r/2;c>=0&&c<=.25*Math.PI||c>1.75*Math.PI&&c<=2*Math.PI?(l-=s/2,u-=r/2*Math.tan(d),h+=s/2,g+=r/2*Math.tan(d)):c>.25*Math.PI&&c<=.75*Math.PI?(u-=r/2,l-=s/2/Math.tan(d),g+=r/2,h+=s/2/Math.tan(d)):c>.75*Math.PI&&c<=1.25*Math.PI?(l+=s/2,u+=r/2*Math.tan(d),h-=s/2,g-=r/2*Math.tan(d)):c>1.25*Math.PI&&c<=1.75*Math.PI&&(u+=r/2,l+=s/2/Math.tan(d),g-=r/2,h-=s/2/Math.tan(d)),e=this._window.document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),e.setAttribute("id",a),e.setAttribute("gradientUnits","userSpaceOnUse"),e.setAttribute("x1",String(Math.round(l))),e.setAttribute("y1",String(Math.round(u))),e.setAttribute("x2",String(Math.round(h))),e.setAttribute("y2",String(Math.round(g)))}t.colorStops.forEach(({offset:t,color:n})=>{const i=this._window.document.createElementNS("http://www.w3.org/2000/svg","stop");i.setAttribute("offset",100*t+"%"),i.setAttribute("stop-color",n),e.appendChild(i)}),c.setAttribute("fill",`url('#${a}')`),this._defs.appendChild(e)}else e&&c.setAttribute("fill",e);this._element.appendChild(c)}}w.instanceCount=0;const v=w,b="canvas",m={};for(let t=0;t<=40;t++)m[t]=t;const y={type:b,shape:"square",width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:m[0],mode:void 0,errorCorrectionLevel:"Q"},imageOptions:{saveAsBlob:!0,hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000",roundSize:!0},backgroundOptions:{round:0,color:"#fff"}};function _(t){const e=Object.assign({},t);if(!e.colorStops||!e.colorStops.length)throw"Field 'colorStops' is required in gradient";return e.rotation?e.rotation=Number(e.rotation):e.rotation=0,e.colorStops=e.colorStops.map(t=>Object.assign(Object.assign({},t),{offset:Number(t.offset)})),e}function k(t){const e=Object.assign({},t);return e.width=Number(e.width),e.height=Number(e.height),e.margin=Number(e.margin),e.imageOptions=Object.assign(Object.assign({},e.imageOptions),{hideBackgroundDots:Boolean(e.imageOptions.hideBackgroundDots),imageSize:Number(e.imageOptions.imageSize),margin:Number(e.imageOptions.margin)}),e.margin>Math.min(e.width,e.height)&&(e.margin=Math.min(e.width,e.height)),e.dotsOptions=Object.assign({},e.dotsOptions),e.dotsOptions.gradient&&(e.dotsOptions.gradient=_(e.dotsOptions.gradient)),e.cornersSquareOptions&&(e.cornersSquareOptions=Object.assign({},e.cornersSquareOptions),e.cornersSquareOptions.gradient&&(e.cornersSquareOptions.gradient=_(e.cornersSquareOptions.gradient))),e.cornersDotOptions&&(e.cornersDotOptions=Object.assign({},e.cornersDotOptions),e.cornersDotOptions.gradient&&(e.cornersDotOptions.gradient=_(e.cornersDotOptions.gradient))),e.backgroundOptions&&(e.backgroundOptions=Object.assign({},e.backgroundOptions),e.backgroundOptions.gradient&&(e.backgroundOptions.gradient=_(e.backgroundOptions.gradient))),e}var S=n(873),C=n.n(S);function x(t){if(!t)throw new Error("Extension must be defined");"."===t[0]&&(t=t.substring(1));const e={bmp:"image/bmp",gif:"image/gif",ico:"image/vnd.microsoft.icon",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",webp:"image/webp",pdf:"application/pdf"}[t.toLowerCase()];if(!e)throw new Error(`Extension "${t}" is not supported`);return e}class B{constructor(t){(null==t?void 0:t.jsdom)?this._window=new t.jsdom("",{resources:"usable"}).window:this._window=window,this._options=t?k(e(y,t)):y,this.update()}static _clearContainer(t){t&&(t.innerHTML="")}_setupSvg(){if(!this._qr)return;const t=new v(this._options,this._window);this._svg=t.getElement(),this._svgDrawingPromise=t.drawQR(this._qr).then(()=>{var e;this._svg&&(null===(e=this._extension)||void 0===e||e.call(this,t.getElement(),this._options))})}_setupCanvas(){var t,e;this._qr&&((null===(t=this._options.nodeCanvas)||void 0===t?void 0:t.createCanvas)?(this._nodeCanvas=this._options.nodeCanvas.createCanvas(this._options.width,this._options.height),this._nodeCanvas.width=this._options.width,this._nodeCanvas.height=this._options.height):(this._domCanvas=document.createElement("canvas"),this._domCanvas.width=this._options.width,this._domCanvas.height=this._options.height),this._setupSvg(),this._canvasDrawingPromise=null===(e=this._svgDrawingPromise)||void 0===e?void 0:e.then(()=>{var t;if(!this._svg)return;const e=this._svg,n=(new this._window.XMLSerializer).serializeToString(e),i=btoa(n),o=`data:${x("svg")};base64,${i}`;if(null===(t=this._options.nodeCanvas)||void 0===t?void 0:t.loadImage)return this._options.nodeCanvas.loadImage(o).then(t=>{var e,n;t.width=this._options.width,t.height=this._options.height,null===(n=null===(e=this._nodeCanvas)||void 0===e?void 0:e.getContext("2d"))||void 0===n||n.drawImage(t,0,0)});{const t=new this._window.Image;return new Promise(e=>{t.onload=()=>{var n,i;null===(i=null===(n=this._domCanvas)||void 0===n?void 0:n.getContext("2d"))||void 0===i||i.drawImage(t,0,0),e()},t.src=o})}}))}async _getElement(t="png"){if(!this._qr)throw"QR code is empty";return"svg"===t.toLowerCase()?(this._svg&&this._svgDrawingPromise||this._setupSvg(),await this._svgDrawingPromise,this._svg):((this._domCanvas||this._nodeCanvas)&&this._canvasDrawingPromise||this._setupCanvas(),await this._canvasDrawingPromise,this._domCanvas||this._nodeCanvas)}update(t){B._clearContainer(this._container),this._options=t?k(e(this._options,t)):this._options,this._options.data&&(this._qr=C()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(t){switch(!0){case/^[0-9]*$/.test(t):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(t):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===b?this._setupCanvas():this._setupSvg(),this.append(this._container))}append(t){if(t){if("function"!=typeof t.appendChild)throw"Container should be a single DOM node";this._options.type===b?this._domCanvas&&t.appendChild(this._domCanvas):this._svg&&t.appendChild(this._svg),this._container=t}}applyExtension(t){if(!t)throw"Extension function should be defined.";this._extension=t,this.update()}deleteExtension(){this._extension=void 0,this.update()}async getRawData(t="png"){if(!this._qr)throw"QR code is empty";const e=await this._getElement(t),n=x(t);if(!e)return null;if("svg"===t.toLowerCase()){const t=`<?xml version="1.0" standalone="no"?>\r\n${(new this._window.XMLSerializer).serializeToString(e)}`;return"undefined"==typeof Blob||this._options.jsdom?Buffer.from(t):new Blob([t],{type:n})}return new Promise(t=>{const i=e;if("toBuffer"in i)if("image/png"===n)t(i.toBuffer(n));else if("image/jpeg"===n)t(i.toBuffer(n));else{if("application/pdf"!==n)throw Error("Unsupported extension");t(i.toBuffer(n))}else"toBlob"in i&&i.toBlob(t,n,1)})}async download(t){if(!this._qr)throw"QR code is empty";if("undefined"==typeof Blob)throw"Cannot download in Node.js, call getRawData instead.";let e="png",n="qr";"string"==typeof t?(e=t,console.warn("Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument")):"object"==typeof t&&null!==t&&(t.name&&(n=t.name),t.extension&&(e=t.extension));const i=await this._getElement(e);if(i)if("svg"===e.toLowerCase()){let t=(new XMLSerializer).serializeToString(i);t='<?xml version="1.0" standalone="no"?>\r\n'+t,o(`data:${x(e)};charset=utf-8,${encodeURIComponent(t)}`,`${n}.svg`)}else o(i.toDataURL(x(e)),`${n}.${e}`)}}const M=B})(),i.default})(),t.exports=e()},7766:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpinnerButton=void 0;const i=n(254);e.SpinnerButton=class{constructor(t){this._isLoading=!1,this.root=t,this.text=(0,i.checkNotNull)(t.querySelector("span"),"Could not find button text"),this.spinner=(0,i.checkNotNull)(t.querySelector(".spinner-border"),"Could not find button spinner")}set isLoading(t){t?(this.spinner.hidden=!1,this.text.hidden=!0):(this.spinner.hidden=!0,this.text.hidden=!1),this._isLoading=t}get isLoading(){return this._isLoading}}},7921:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.baseDiagnostic=void 0;const o=n(4111),r=n(8004),s=n(5794),a=n(9675),d=n(1931),c=n(4810),l=i(n(1857)),u=n(6148),h=n(6564),g=n(9735),f=n(6336),p=n(2206);e.baseDiagnostic=(0,o.diagnosticGroupOf)("baseDiagnostic",r.BrowserDiagnosticCollector.connect(l.default.getInstance()),new a.ExtensionDiagnosticCollector,d.WebLocationDiagnosticCollector.connect(l.default.getInstance()),c.AccountDiagnosticCollector.connect(l.default.getInstance()),s.ConnectivityDiagnosticCollector.connect(l.default.getInstance()),u.ContentDiagnosticCollector.connect(l.default.getInstance(),"quizMeta"),h.SettingsDiagnosticCollector.connect(l.default.getInstance()),g.MagicButtonStateDiagnosticCollector.connect(l.default.getInstance()),f.ActiveTabDiagnosticCollector.connect(l.default.getInstance()),p.LogsDiagnosticCollector.connect(l.default.getInstance()))},8344:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.SettingsPage=void 0;const o=n(8376),r=i(n(859)),s=i(n(7150)),a=i(n(3259)),d=n(5263),c=n(254),l=n(2432),u=n(5699);class h{constructor(t){this.root=t,this.widgetToggleHotkey=(0,c.checkNotNull)(t.querySelector("#widget-toggle-hotkey"),"Could not find widget toggle hotkey input"),this.widgetToggleDoubleClick=(0,c.checkNotNull)(t.querySelector("#widget-toggle-double-click"),"Could not find widget toggle hotkey input"),this.hideWidgetByDefault=(0,c.checkNotNull)(t.querySelector("#hide-widget-by-default"),"Could not find hide widget by default input"),this.hideNotifications=(0,c.checkNotNull)(t.querySelector("#hide-notifications"),"Could not find hide notifications input"),this.saveButton=(0,c.checkNotNull)(t.querySelector("#save-settings"),"Could not find save button"),this.backButton=(0,c.checkNotNull)(t.querySelector("#back"),"Could not find back button"),this.infoSection=(0,c.checkNotNull)(t.querySelector("#info-section"),"Could not find info section"),this.otherSection=(0,c.checkNotNull)(t.querySelector("#other-section"),"Could not find other settings section"),this.supportButton=(0,c.checkNotNull)(t.querySelector("#support"),"Could not find profile button"),this.contactButton=(0,c.checkNotNull)(t.querySelector("#contact"),"Could not find contact button"),this.docsButton=(0,c.checkNotNull)(t.querySelector("#docs"),"Could not find docs button")}static inflate(){const t=document.createElement("div");return t.id=this.LAYOUT_ID,t.innerHTML=s.default,t.hidden=!0,new h(t)}}h.LAYOUT_ID="settings-page";class g extends o.BasePage{constructor(t,e){super(t),this.binding=h.inflate(),this.popup=new l.PopupBinding,this.binding.saveButton.addEventListener("click",()=>{this.onClickSaveSettings()}),this.binding.docsButton.addEventListener("click",()=>{this.onClickDocsButton()}),this.binding.contactButton.addEventListener("click",()=>{this.onClickContactButton()}),this.binding.supportButton.addEventListener("click",()=>{this.onClickSupportButton()}),e?(this.binding.infoSection.hidden=!0,this.binding.otherSection.hidden=!1,this.binding.backButton.addEventListener("click",()=>{this.onClickBackButton()})):(this.binding.infoSection.hidden=!1,this.binding.otherSection.hidden=!0,this.binding.backButton.hidden=!0),a.default.filter=function(t){const e=t.target??t.srcElement;return e instanceof HTMLInputElement&&"widget-toggle-hotkey"===e.id},(0,a.default)("*",()=>(this.binding.widgetToggleHotkey.value=a.default.getPressedKeyString().join("+"),!1))}render(t){this.binding.widgetToggleHotkey.value=t.widgetToggleHotkey,this.binding.widgetToggleDoubleClick.checked=t.widgetToggleDoubleClick,this.binding.hideWidgetByDefault.checked=t.hideWidgetByDefault,this.binding.hideNotifications.checked=t.hideNotifications}show(){document.querySelector("#"+h.LAYOUT_ID)||this.popup.container.prepend(this.binding.root),this.bus.publishToBackground(r.default.GetSettings).then(t=>{if(!(0,d.isSettings)(t))throw Error("Could not load settings");this.render(t)}),this.binding.root.hidden=!1}hide(){this.binding.root.hidden=!0}readUserInput(){return{widgetToggleHotkey:this.binding.widgetToggleHotkey.value,widgetToggleDoubleClick:this.binding.widgetToggleDoubleClick.checked,hideWidgetByDefault:this.binding.hideWidgetByDefault.checked,hideNotifications:this.binding.hideNotifications.checked}}async onClickSaveSettings(){const t={...await this.bus.publishToBackground(r.default.GetSettings),...this.readUserInput()};await this.bus.publishToBackground(r.default.SetSettings,t),window.close()}onClickBackButton(){this.navigateTo(u.PageTag.Main)}onClickSupportButton(){window.open("https://syncshare.naloaty.me/#donation","_blank")?.focus(),window.close()}onClickDocsButton(){window.open("https://syncshare.naloaty.me/docs","_blank")?.focus(),window.close()}onClickContactButton(){navigator.clipboard.writeText("syncshare.ext@gmail.com"),alert("Электропочта скопирована в буффер обмена."),window.close()}}e.SettingsPage=g},8376:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BasePage=void 0;const i=n(5699);e.BasePage=class{constructor(t){this.bus=t}navigateTo(t){this.bus.publishLocally(i.NavigationEvent.Topic,new i.NavigationEvent.OpenPage(t))}}},9675:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtensionDiagnosticCollector=void 0;const i=n(6148);class o extends i.ContentDiagnosticCollector{constructor(){super(...arguments),this.key=o.key}static get key(){return"extension"}async collect(){return{version:"2.11.0",buildTarget:"chrome",isAnalyticsEnabled:!0,loggingLevel:"warn"}}}e.ExtensionDiagnosticCollector=o}},n={};function i(t){var o=n[t];if(void 0!==o)return o.exports;var r=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}i.m=e,t=[],i.O=(e,n,o,r)=>{if(!n){var s=1/0;for(l=0;l<t.length;l++){for(var[n,o,r]=t[l],a=!0,d=0;d<n.length;d++)(!1&r||s>=r)&&Object.keys(i.O).every(t=>i.O[t](n[d]))?n.splice(d--,1):(a=!1,r<s&&(s=r));if(a){t.splice(l--,1);var c=o();void 0!==c&&(e=c)}}return e}r=r||0;for(var l=t.length;l>0&&t[l-1][2]>r;l--)t[l]=t[l-1];t[l]=[n,o,r]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.j=887,(()=>{var t,e=!!(()=>{try{return browser.runtime.getURL("/")}catch(t){}})(),n=!!(()=>{try{return chrome.runtime.getURL("/")}catch(t){}})(),o=e?browser:n?chrome:{get runtime(){throw new Error("No chrome or browser runtime found")}};i.g.importScripts&&(t=i.g.location+"");var r=i.g.document;if(!t&&r&&r.currentScript&&(t=r.currentScript.src),!t){if(!n&&!e)throw new Error("Automatic publicPath is not supported in this browser");t=o.runtime.getURL("/")}t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t+"../"})(),(()=>{i.b=document.baseURI||self.location.href;var t={887:0};i.O.j=e=>0===t[e];var e=(e,n)=>{var o,r,[s,a,d]=n,c=0;if(s.some(e=>0!==t[e])){for(o in a)i.o(a,o)&&(i.m[o]=a[o]);if(d)var l=d(i)}for(e&&e(n);c<s.length;c++)r=s[c],i.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return i.O(l)},n=self.webpackChunksyncshare_extension=self.webpackChunksyncshare_extension||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var o=i.O(void 0,[223],()=>i(1940));o=i.O(o)})();